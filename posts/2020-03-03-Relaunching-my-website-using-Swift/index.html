<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Maximilian Götzfried"/><link rel="canonical" href="https://mxgzf.github.io/posts/2020-03-03-Relaunching-my-website-using-Swift"/><meta name="twitter:url" content="https://mxgzf.github.io/posts/2020-03-03-Relaunching-my-website-using-Swift"/><meta name="og:url" content="https://mxgzf.github.io/posts/2020-03-03-Relaunching-my-website-using-Swift"/><title>Relaunching my website using Swift | Maximilian Götzfried</title><meta name="twitter:title" content="Relaunching my website using Swift | Maximilian Götzfried"/><meta name="og:title" content="Relaunching my website using Swift | Maximilian Götzfried"/><meta name="description" content="I recently rebuilt my website using Swift and John Sundell's Publish framework"/><meta name="twitter:description" content="I recently rebuilt my website using Swift and John Sundell's Publish framework"/><meta name="og:description" content="I recently rebuilt my website using Swift and John Sundell's Publish framework"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Maximilian Götzfried"/></head><body><article><header><h1>Relaunching my website using Swift</h1><p>by <a href="/">Maximilian Götzfried</a> on <time datetime="2020-05-03" title="March 5, 2020">March 5, 2020</time datetime="2020-05-03" title="March 5, 2020"></p></header><p>I recently rebuilt my website using Swift and John Sundell's <a href="https://github.com/JohnSundell/Publish">Publish</a> framework and i can't recommend it enough. It was a lot of fun.</p><p>It's just great to be able to use the familiar <code>DateFormatter</code> to format dates of blog posts. Or to use a <code>forEach</code> loop to create a list of posts that are sorted using a key path:</p><pre><code><span class="keyword">let</span> items = context.<span class="call">allItems</span>(sortedBy: \.<span class="property">date</span>, order: .<span class="dotAccess">descending</span>)
<span class="keyword">return</span> <span class="type">HTML</span>(
    .<span class="call">body</span>(
        .<span class="call">ul</span>(
            .<span class="call">id</span>(<span class="string">"posts"</span>),
            .<span class="call">forEach</span>(items) { item <span class="keyword">in</span>
                .<span class="call">li</span>(
                    .<span class="call">article</span>(
                        .<span class="call">a</span>(.<span class="call">href</span>(item.<span class="property">path</span>), .<span class="dotAccess">text</span>(item.<span class="property">title</span>)),
                        .<span class="call">p</span>(.<span class="call">text</span>(item.<span class="property">description</span>))
                    )
                )
            }
        )
    )
)
</code></pre><h3>Installation and setup</h3><p>After following the <a href="https://github.com/JohnSundell/Publish#installation">instructions</a> you end up with two things:</p><ul><li>A Swift package that generates a static website every time you hit “Run”. Including a sitemap and a RSS feed. It also applies syntax highlighting to your code blocks if you want to, it adds CNAME files if you need to and pushes it to your GitHub pages repo if you wish to.</li><li>And a local HTTP server to test your site</li></ul><p>If you look at <a href="https://github.com/mxgzf/mxgzf.com">my code</a> you see that the final result is pretty straightforward and well organized. I chose a very reduced approach. That's why there are only three Swift files in my package.</p><h3>Adding additional resources</h3><p>Publish requires that resources (images, stylesheets, …) are put in a separate folder <code>Resources</code>, outside of the <code>Content</code> folder:</p><img src="/images/Publish-resources-in-a-separate-folder@2x.png" alt="Publish requires that resources are put in a separate folder Resources" style="zoom:50%;" /><p>During the publishing process it copies the resources to the root level of the <code>Output</code> folder:</p><img src="/images/Publish-output-folder@2x.png" alt="During the publishing process resources are copied to the root level of the Output folder" style="zoom:50%;" /><p>This is implemented in <code>PublishingStep.copyResources(at:to:includingFolder:)</code>.</p><h3>Adding images to posts when editing</h3><p>I found that <a href="https://typora.io">Typora</a> is the best solution to write new posts, especially when it comes to dealing with images. Typora supports both custom root urls and copying images to custom folders.</p><p>To support Publish's resource structure i add these two lines to the YAML front matter of the markdown document of each post:</p><pre><code>typora-copy-images-to: ../../<span class="type">Resources</span>/images
typora-root-url: ../../<span class="type">Resources</span>
</code></pre><p>So whenever i add an image to a post, for example by drag &amp; drop, it automatically copies the image to the <code>Resources</code> folder of my Publish repository and sets the image url to <code>/images/&lt;filename&gt;</code>. The only requirement is that the markdown document needs to be saved to the <code>posts</code> folder before adding images.</p><p>By the way: These custom metadata fields are ignored during the publishing process because i don't define them in the <code>WebsiteItemMetadata</code> struct of my site definition. So they don't show up in the generated HTML.</p><h3>Flashing the posts list</h3><p>I decided to put the list of blog posts at the end of the index page. I know, this is weird. But at the moment it is more important to present me as a freelancer than list my posts.</p><p>I thought it would be nice to flash the posts list when a visitor follows the link in the description that jumps to that list, similar to what Stack Overflow is doing <a href="https://stackoverflow.com/questions/49726196/swift-3-function-inside-dispatchqueue/49763932#49763932">when linking to answers</a>.</p><p>To do this, i added <code>.id("posts")</code> to the posts list in <code>MyHTMLFactory.makeIndexHTML(for:context:)</code>. Then, to flash the posts list when the anchor is clicked, i added an animation to <code>.posts:target</code> in the CSS:</p><pre><code>#posts:<span class="call">target</span> {
    animation: flash 2s;
}
<span class="keyword">@keyframes</span> <span class="call">flash</span> {
   <span class="call">from</span> { background: <span class="call">rgba</span>(<span class="number">254</span>, <span class="number">255</span>, <span class="number">0</span>, <span class="number">0.40</span>); }
   <span class="call">to</span> { background: transparent; }
}
</code></pre><p>This solution is similar to <a href="https://codepen.io/Founts/pen/mPwbbW">this CodePen</a>.</p><h3>Supporting dark mode</h3><p>To support dark mode i first tell the browser in the stylesheet that my site supports both light and dark mode. It will then redraw the site when the user switches between these modes:</p><pre><code>:<span class="call">root</span> {
    color-scheme: light dark;
}
</code></pre><p>Then, i defined the colors using a <code>@media</code> query:</p><pre><code><span class="keyword">@media</span> (prefers-color-scheme: dark) { … }
</code></pre><h3>Highlighting syntax</h3><p>Publish has a plug-in for John Sundell's <a href="https://github.com/JohnSundell/Splash">Splash</a>, a Swift syntax highlighter that adds colors to your code blocks by adding CSS classes to your HTML:</p><pre><code>&lt;span <span class="keyword">class</span>=<span class="string">"keyword"</span>&gt;<span class="keyword">func</span>&lt;/span&gt; <span class="call">hello</span>(world: &lt;span <span class="keyword">class</span>=<span class="string">"type"</span>&gt;<span class="type">String</span>&lt;/span&gt;) -&gt; &lt;span <span class="keyword">class</span>=<span class="string">"type"</span>&gt;<span class="type">Int</span>&lt;/span&gt;
</code></pre><p>Adding this plugin is pretty simple because you just have to add one line of code to your main <code>publish</code> call:</p><pre><code><span class="keyword">try</span> <span class="type">MySite</span>().<span class="call">publish</span>(
    withTheme: .<span class="dotAccess">myTheme</span>,
    additionalSteps: [],
    plugins: [
        .<span class="call">splash</span>(withClassPrefix: <span class="string">""</span>)
    ]
)
</code></pre><p>For the colors i just use Xcode's default colors:</p><pre><code><span class="comment">/* light colors */</span>
pre code .<span class="call">keyword</span> { color: #9b2393; }
pre code .<span class="call">type</span> { color: #0b4f79; }
pre code .<span class="call">call</span> { color: #326d74; }
pre code .<span class="call">property</span> { color: #326d74; }
pre code .<span class="call">number</span> { color: #1c00cf; }
pre code .<span class="call">string</span> { color: #c41a16; }
pre code .<span class="call">comment</span> { color: #5d6c79; }
pre code .<span class="call">dotAccess</span> { color: #326d74; }
pre code .<span class="call">preprocessing</span> { color: #643820; }

<span class="comment">/* dark colors */</span>
pre code .<span class="call">keyword</span> { color: #fc5fA3; }
pre code .<span class="call">type</span> { color: #5dd8ff; }
pre code .<span class="call">call</span> { color: #67b7a4; }
pre code .<span class="call">property</span> { color: #67b7a4; }
pre code .<span class="call">number</span> { color: #d0bf69; }
pre code .<span class="call">string</span> { color: #fc6a5d; }
pre code .<span class="call">comment</span> { color: #6c7986; }
pre code .<span class="call">dotAccess</span> { color: #67b7a4; }
pre code .<span class="call">preprocessing</span> { color: #fd8f3f; }
</code></pre><h3>The code</h3><p>You can find the Swift package for my website on GitHub at <a href="https://github.com/mxgzf/mxgzf.com">mxgzf/mxgzf.com</a> and the generated website at <a href="https://github.com/mxgzf/mxgzf.github.io">mxgzf/mxgzf.github.io</a>.</p><h3>More</h3><p>Check out the following links if you want to learn more about creating and maintaining websites using Swift and Publish:</p><p><a href="https://github.com/JohnSundell/Publish/pulls?utf8=✓&q=is%3Apr">This list of pull requests</a> gives you a good overview what others contributed to Publish.</p><p>Two plug-ins for Publish:</p><ul><li><a href="https://github.com/SwiftyGuerrero/CNAMEPublishPlugin">CNAMEPublishPlugin</a> generates CNAME files to support custom domain names</li><li><a href="https://github.com/john-mueller/TidyHTMLPublishStep">TidyHTMLPublishStep</a> formats your HTML using <a href="https://github.com/scinfu/SwiftSoup">SwiftSoup</a></li></ul><p>Other sites built with Publish:</p><ul><li><a href="https://github.com/abrampers/personal-site-swift">https://github.com/abrampers/personal-site-swift</a> →<a href="https://abrampers.com">https://abrampers.com</a></li><li><a href="https://github.com/acam002/Blog">https://github.com/acam002/Blog</a> →<a href="https://acam002.github.io">https://acam002.github.io</a></li><li><a href="https://github.com/alvareztech/alvareztech">https://github.com/alvareztech/alvareztech</a> →<a href="https://alvarez.tech">https://alvarez.tech</a></li><li><a href="https://github.com/brorhb/brurberg-dev">https://github.com/brorhb/brurberg-dev</a> →<a href="https://www.brurberg.dev">https://www.brurberg.dev</a></li><li><a href="https://github.com/crelies/christianelies.de">https://github.com/crelies/christianelies.de</a> →<a href="https://christianelies.de">https://christianelies.de</a></li><li><a href="https://github.com/fbernutz/die-himmelstraeumerin-blog">https://github.com/fbernutz/die-himmelstraeumerin-blog</a> →<a href="https://fbernutz.github.io">https://fbernutz.github.io</a></li><li><a href="https://github.com/hggz/hggz.github.io">https://github.com/hggz/hggz.github.io</a> →<a href="https://hggz.github.io">https://hggz.github.io</a></li><li><a href="https://github.com/hngry/hungry.dev">https://github.com/hngry/hungry.dev</a> →<a href="https://hungry.dev">https://hungry.dev</a></li><li><a href="https://github.com/Jimmy-Lee/jimmy-lee">https://github.com/Jimmy-Lee/jimmy-lee</a> →<a href="https://jimmy-lee.github.io">https://jimmy-lee.github.io</a></li><li><a href="https://github.com/leontedev/Publish-leonte.dev">https://github.com/leontedev/Publish-leonte.dev</a> →<a href="https://www.leonte.dev">https://www.leonte.dev</a></li><li><a href="https://github.com/lozhuf/lauriehufford.com">https://github.com/lozhuf/lauriehufford.com</a> →<a href="https://www.lauriehufford.com">https://www.lauriehufford.com</a></li><li><a href="https://github.com/mazo20/personalWebsite">https://github.com/mazo20/personalWebsite</a> →<a href="https://mkowalski.me">https://mkowalski.me</a></li><li><a href="https://github.com/navanchauhan/My-Website-Swift">https://github.com/navanchauhan/My-Website-Swift</a> →<a href="https://navanchauhan.github.io">https://navanchauhan.github.io</a></li><li><a href="https://github.com/ncreated/ncreated.com">https://github.com/ncreated/ncreated.com</a> →<a href="https://ncreated.com">https://ncreated.com</a></li><li><a href="https://github.com/nitesuit/Blog">https://github.com/nitesuit/Blog</a> →<a href="https://www.staskus.io">https://www.staskus.io</a></li><li><a href="https://github.com/peteschaffner/peteschaffner.com">https://github.com/peteschaffner/peteschaffner.com</a> →<a href="https://peteschaffner.com">https://peteschaffner.com</a></li><li><a href="https://github.com/Rubenfer/RubenAppWeb-Project">https://github.com/Rubenfer/RubenAppWeb-Project</a> →<a href="https://ruben.app">https://ruben.app</a></li><li><a href="https://github.com/SwiftyDorado/static-blog">https://github.com/SwiftyDorado/static-blog</a> →<a href="https://swiftydorado.github.io">https://swiftydorado.github.io</a></li><li><a href="https://github.com/TonyStarkLi/Blog">https://github.com/TonyStarkLi/Blog</a> →<a href="https://www.tonystarkli.com">https://www.tonystarkli.com</a></li><li><a href="https://github.com/zorkdev/Website">https://github.com/zorkdev/Website</a> →<a href="https://www.attilanemet.com">https://www.attilanemet.com</a></li></ul><p>◼</p></article></body></html>